<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv='X-UA-Compatible' content='IE=edge;chrome=1' />
    <title>Drop of Will - rtasklib update march 16th</title>

    <link rel="alternate" type="application/atom+xml" title="Atom Feed" href="/feed.xml" />

    <link href="/blog/stylesheets/main-10699714.css" rel="stylesheet" type="text/css" />

    <!-- Viewport declarations -->
    <meta name="viewport" content="width=533">
    <meta name="viewport" content="initial-scale=0.6">
  </head>
  <body>

    <header class="hero">
<a href="/blog">        <h1>
          &lambda;will.paul
        </h1>
</a>      <hr>
    </header>

    <div class="typeset" role="main">

        <article class="article">
    <h1>rtasklib update march 16th</h1>
		<p>Over the last couple of weeks the overall architecture has been in a state of flux as I have been swapping pieces in out to see what will work best. Now as I approach my original milestone for having this in a working condition things are starting to fall into place. Models for tasks and configuration are pretty much stable, initialization of the configuration is done, and validation and serialization of tasks are coming along. The main bit of work left to do is writing the controllers to hook all of the components together and will effectively make up the public interface for the library.</p>

<h2 id="a-little-implementation-detail">A little implementation detail</h2>

<p>For the configuration file I decided to effectively store it as a shallow hash structure before converting it to a Virtus domain object. The config will be immutable because there should not be a need to both permanently and dynamically change the users configurations, the latter alone can be configured on a per call basis with the <code>rc:</code> flag. Because of this we only have to go in one direction, which makes the serialization layer less restrictive. As I mentioned last week <code>taskw</code> implemented a deep nested hash like this:</p>

<pre class="highlight plaintext"><code>rc["color"]["label"]["sort"] = 'gray10'
# which makes this (a default config) impossible to store as well
rc["color"] = 'on'
</code></pre>

<p>I went with the simplest solution I could come up with, which was to treat each of the paths as unique keys in a shallow hash (while converting periods to underscores to follow a Ruby convention), something like this (using Ruby symbols, instead of strings for the keys):</p>

<pre class="highlight plaintext"><code>rc[:color_label_sort] = 'gray10'
rc[:color] = 'on'
</code></pre>

<p>From there its just a matter of converting the hash to a Virtus object. Usually a Virtus attribute has a set type so that it knows what to coerce to, but in this case there are over 200 configurations in the default config and of course a config can contain arbitrary stuff from the user or another plugin, so there is no way to set this all up before hand. Luckily Virtus comes metaprogramming ready and it was easy enough to add attributes on the fly, I simply checked for booleans (including TW’s idea of “yes”/”no” and “on”/”off”), floats, integers, and the finally just said everything else was a string and to just keep it like it is.</p>

<h2 id="moving-forward">Moving forward</h2>

<p>I plan to have a basic controller implementation in place by the end of next week or sometime during Spring Break. Once that’s in place I’ll be able to start splitting time between <code>task_time</code> and <code>rtasklib</code> again.</p>


    <div class="article-comments">
			<div id="disqus_thread">
	
	<script async="true" src="http://dropofwill.disqus.com/embed.js" type="text/javascript"></script>
	<noscript>
		<a>(href="http://#{short_name}.disqus.com/embed.js?url=ref") View comments.</a>
	</noscript>
</div>

    </div>
  </article>

      <hr>

      <aside>
        <h2>Recent Articles</h2>
        <ol>
            <li><a href="/blog/2015/05/20/a-scanner-orderly-the-smart-coaster/">A Scanner Orderly: The smart coaster</a> <span>May 20</span></li>
            <li><a href="/blog/2015/05/19/rtasklib-first-release/">rtasklib first release</a> <span>May 19</span></li>
            <li><a href="/blog/2015/05/15/meetup-at-ibm-in-austin-tx/">Meetup at IBM in Austin, TX</a> <span>May 15</span></li>
            <li><a href="/blog/2015/05/10/packaging-ruby-gems/">Packaging Ruby gems</a> <span>May 10</span></li>
            <li><a href="/blog/2015/04/20/rtasklib-update/">rtasklib update</a> <span>Apr 20</span></li>
            <li><a href="/blog/2015/04/14/playing-power-chords-on-an-arduino/">Playing power chords on an Arduino</a> <span>Apr 14</span></li>
            <li><a href="/blog/2015/04/06/vmware-gpl-case-update/">VMware GPL case update</a> <span>Apr  6</span></li>
            <li><a href="/blog/2015/04/06/rtasklib-update-ruby-and-external-tools/">rtasklib update: Ruby and external tools</a> <span>Apr  6</span></li>
            <li><a href="/blog/2015/03/31/lit-review-of-the-quantifying-the-value-of-open-source-hardware-development/">Review of: the Quantifying the Value of Open Source Hardware Development</a> <span>Mar 31</span></li>
            <li><a href="/blog/2015/03/28/mouse-rat-technical-explanation/">Mouse Rat: Technical explanation</a> <span>Mar 28</span></li>
        </ol>

        <h2>Tags</h2>
        <ol class="columnize">
            <li><a href="/blog/tags/linuxdev/">LinuxDev (11)</a></li>
            <li><a href="/blog/tags/task_time/">task_time (4)</a></li>
            <li><a href="/blog/tags/physical-computing/">Physical Computing (5)</a></li>
            <li><a href="/blog/tags/bizleg/">BizLeg (21)</a></li>
            <li><a href="/blog/tags/arduino/">Arduino (5)</a></li>
            <li><a href="/blog/tags/hfoss/">HFOSS (4)</a></li>
            <li><a href="/blog/tags/bugfix/">Bugfix (1)</a></li>
            <li><a href="/blog/tags/javascript/">JavaScript (3)</a></li>
            <li><a href="/blog/tags/c/">C (1)</a></li>
            <li><a href="/blog/tags/data-viz/">Data Viz (3)</a></li>
            <li><a href="/blog/tags/ruby/">Ruby (14)</a></li>
            <li><a href="/blog/tags/middleman/">Middleman (3)</a></li>
            <li><a href="/blog/tags/blog/">Blog (2)</a></li>
            <li><a href="/blog/tags/deployment/">Deployment (1)</a></li>
            <li><a href="/blog/tags/reviews/">Reviews (2)</a></li>
            <li><a href="/blog/tags/trademark/">Trademark (2)</a></li>
            <li><a href="/blog/tags/d3/">D3 (1)</a></li>
            <li><a href="/blog/tags/gpl/">GPL (2)</a></li>
            <li><a href="/blog/tags/licenses/">Licenses (4)</a></li>
            <li><a href="/blog/tags/review/">Review (8)</a></li>
            <li><a href="/blog/tags/legal/">Legal (1)</a></li>
            <li><a href="/blog/tags/econ/">Econ (2)</a></li>
            <li><a href="/blog/tags/meetup/">Meetup (1)</a></li>
            <li><a href="/blog/tags/wearables/">Wearables (2)</a></li>
            <li><a href="/blog/tags/mouse-rat/">Mouse Rat (2)</a></li>
            <li><a href="/blog/tags/vim/">Vim (3)</a></li>
            <li><a href="/blog/tags/config/">Config (3)</a></li>
            <li><a href="/blog/tags/business/">Business (1)</a></li>
            <li><a href="/blog/tags/rtasklib/">rtasklib (7)</a></li>
            <li><a href="/blog/tags/patents/">Patents (2)</a></li>
            <li><a href="/blog/tags/foss/">FOSS (1)</a></li>
            <li><a href="/blog/tags/remix/">Remix (2)</a></li>
            <li><a href="/blog/tags/ip/">IP (1)</a></li>
            <li><a href="/blog/tags/processing/">Processing (1)</a></li>
            <li><a href="/blog/tags/nlp/">NLP (2)</a></li>
            <li><a href="/blog/tags/semantics/">Semantics (2)</a></li>
            <li><a href="/blog/tags/video/">Video (1)</a></li>
            <li><a href="/blog/tags/talk/">Talk (1)</a></li>
            <li><a href="/blog/tags/functional-programming/">Functional Programming (1)</a></li>
            <li><a href="/blog/tags/python/">Python (1)</a></li>
        </ol>

        <h2>By Year</h2>
        <ol>
            <li><a href="/blog/2015/">2015 (31)</a></li>
            <li><a href="/blog/2014/">2014 (16)</a></li>
        </ol>
      </aside>
    </div>
  </body>
</html>
